<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="../../tasks.css">
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Corresponder</title>
</head>
<body>

<h2>Corresponder o caractere e seu significado</h2>
<p class="instruction">Selecionar o significado de cada caractere</p>

<div id="pairs-container">
<!-- Os pares serão adicionados dinamicamente -->
</div>

<button onclick="check()">Verificar</button>
<p id="result"></p>

<script>
const wordBank = [
{ char: "丙", correct: "3º Tronco Celestial" },
{ char: "卜", correto: "ler a sorte" },
{ char: "雨", correto: "chuva" },
{ char: "王", correto: "governante" },
{ char: "貞", correto: "perguntar a um oráculo" },
{ char: "曰", correto: "dizer, pronunciar" },
{ char: "允", correto: "de fato" },
{ char: "占", correto: "interpretar" }
];

const allValues ​​​​= wordBank.map(item => item.correct);

function shuffleArray(array) {
const arr = [...array];
para (seja i = arr.length - 1; i > 0; i--) {
const j = Math.floor(Math.random() * (i + 1));
[arr[i], arr[j]] = [arr[j], arr[i]];
}
return arr;
}

function renderPairs() {
const container = document.getElementById("pairs-container");
container.innerHTML = "";

const shuffled = shuffleArray(wordBank);

embaralhado.paraCada(item => {
const par = document.createElement("div");
par.className = "par";

const opções = embaralharArray([...allValues]);

deixe selectHTML = `<select id="char_${item.char}">
<valor da opção="">— selecionar —</opção>`;

opções.paraCada(valor => {
selecioneHTML += `<valor da opção="${valor}">${valor}</opção>`;
});

selecioneHTML += `</select>`;

par.innerHTML = `<rótulo>${item.char} →</rótulo> ${selectHTML}`;
contêiner.appendChild(par);
});
}

função verificar() {
deixe allFilled = true;
deixe correctCount = 0;

wordBank.forEach(item => {
const select = document.getElementById(`char_${item.char}`);
if (!select || !select.value) allFilled = false;
if (select?.value === item.correct) correctCount++;
});

const resultEl = document.getElementById("result");

if (!allFilled) {
resultEl.textContent = "Preencha tudo.";
resultEl.className = "error";
sendResult(false, "Nem todos os campos foram preenchidos");
return;
}

if (correctCount === wordBank.length) {
resultEl.textContent = "✅ Isso mesmo!";
resultEl.className = "success";
sendResult(true);
} else {
const hint = "Dica: 卜 — palpite, 貞 — pergunta, 允 — realmente.";
resultEl.textContent = "❌ " + hint;
resultEl.className = "erro";
sendResult(false, "Erro de correspondência");
}
}

function sendResult(sucesso, mensagem) {
window.parent.postMessage({
type: "TASK_RESULT",
sucesso,
mensagem: mensagem || (sucesso ? "Tudo está correto" : "Erro")
}, "*");
}

window.onload = renderPairs;
window.parent.postMessage({ type: "TASK_EXISTS", valid: true }, "*");
</script>
</body>
</html>