<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="../../tasks.css">
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>O que acontece no dia de hoje?</title>
</head>
<body>

<h2>O que acontece no dia de hoje?</h2>

<div class="oracle-text">Atividades de hoje</div>

<div class="pinyin-container">
<button class="pinyin-toggle" onclick="this.nextElementSibling.classList.toggle('expanded')">
Pinyin ▼
</button>
<div class="pinyin-text">guǐ chǒu yǔn qí yǔ</div>
</div>

<div class="options" id="options-container">
<!-- As opções serão adicionadas dinamicamente -->
</div>

<button onclick="check()">Verificar</button>
<p id="result"></p>

<script>
const options = [
{ value: "rain-coming", text: "Vai chover", correct: false },
{ value: "no-rain", text: "Não vai chover", correct: false },
{ value: "rained", text: "Choveu mesmo", correct: true },
{ value: "divined", text: "O governante estava se perguntando", correct: false }
];

let selectedValue = null;

function shuffleArray(array) {
const arr = [...array];
for (let i = arr.length - 1; i > 0; i--) {
const j = Math.floor(Math.random() * (i + 1));
[arr[i], arr[j]] = [arr[j], arr[i]];
}
return arr;
}

function renderOptions() {
const container = document.getElementById("options-container");
container.innerHTML = "";

const shuffled = shuffleArray(options);

embaralhado.forEach(opção => {
const rótulo = document.createElement("rótulo");
rótulo.className = "opção";

const entrada = document.createElement("entrada");
entrada.tipo = "rádio";
entrada.nome = "q";
entrada.valor = opção.valor;

entrada.onchange = () => {
valor selecionado = opção.valor;
document.querySelectorAll('.opção').forEach(el => el.classList.remove('selecionado'));
rótulo.classList.add('selecionado');
};

const textNode = document.createTextNode(opção.texto);
rótulo.appendChild(entrada);
rótulo.appendChild(nótexto);
contêiner.appendChild(rótulo);
});
}

function check() {
if (!selectedValue) {
const resultEl = document.getElementById("result");
resultEl.textContent = "Selecione uma opção.";
resultEl.className = "error";
return;
}

const isCorrect = selectedValue === "choveu";
const resultEl = document.getElementById("result");

if (isCorrect) {
resultEl.textContent = "✅ Correto! Dia chuvoso = "e realmente choveu."";
resultEl.className = "sucesso";
sendResult(true);
} else {
resultEl.textContent = "❌ Dia chuvoso é uma confirmação, não uma previsão.";
resultEl.className = "error";
sendResult(false, "Erro na interpretação de 允");
}
}

function sendResult(sucesso, mensagem) {
window.parent.postMessage({
type: "TASK_RESULT",
sucesso,
mensagem: mensagem || (sucesso ? "Verdadeiro" : "Erro")
}, "*");
}

window.onload = renderOptions;
window.parent.postMessage({ type: "TASK_EXISTS", válido: verdadeiro }, "*");
</script>
</body>
</html>