<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="../../tasks.css">
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Corresponder</title>
</head>
<body>

<h2>Corresponder o caractere e seu significado</h2>
<p class="intro">Clique no caractere e, em seguida, no significado</p>

<div class="column">
<h3>Hieróglifos</h3>
<div id="words"></div>
</div>

<div class="column">
<h3>Significados</h3>
<div id="defs"></div>
</div>

<button onclick="reset()">Redefinir</button>
<p id="result"></p>

<script>
const pairs = [
{ char: "不", que significa: "Não; como em 'não vai chover'" },
{ char: "王", que significa: "Governante/Rei" },
{ char: "丙", que significa: "Raiz Celestial (3º)" },
{ char: "占", que significa: "Interpretar adivinhação" },
{ char: "曰", que significa: "Falar; introduz a fala" }
];

let selectedWord = null;
let matchedPairs = 0;

function shuffle(arr) {
return [...arr].sort(() => Math.random() - 0.5);
}

function init() {
const ListaDePalavras = document.getElementById("palavras");
const ListaDeDeFs = document.getElementById("defs");

ListaDePalavras. HTMLInterno = "";

ListaDeDeFs. HTMLInterno = "";

const Caract.Embaralhados = embaralhar(pares);
const SignificadosEmbaralhados = embaralhar(pares. mapa(p => p. significado));

// Cria hieróglifos
Caract.Embaralhados. paraCada(item => {
const el = document. criarElemento("div");
el. NomeDaClasse = "item-palavra";
el. conjuntoDeDados. char = item. char;
el. ConteúdoDoTexto = item. char;
el. aoClicar = () => selecionarPalavra(el);
ListaDePalavras. acrescentarFilho(el);
});

// Cria valores
shuffledMeanings.forEach(meaning => {
const el = document.createElement("div");
el.className = "def-item";
el.dataset.meaning = meaning;
el.textContent = meaning;
el.onclick = () => selectDefinition(el);
defList.appendChild(el);
});
}

function selectWord(el) {
if (el.classList.contains("matched")) return;
document.querySelectorAll(".word-item.selected").forEach(e => e.classList.remove("selected"));
selectedWord = null;
el.classList.add("selected");
selectedWord = el;
}

function selectDefinition(el) {
if (el.classList.contains("correspondente") || !selectedWord) return;

const char = selectedWord.dataset.char;
const meaning = el.dataset.meaning;
const isCorrect = pairs.some(p => p.char === char && p.meaning === meaning);

if (isCorrect) {
el.classList.add("correspondente");
selectedWord.classList.add("correspondente");
selectedWord.onclick = null;
el.onclick = null;
selectedWord = null;
matchedPairs++;

if (matchedPairs === 5) {
const resultEl = document.getElementById("result");
resultEl.textContent = "✅ Isso mesmo!";
resultEl.className = "sucesso";
sendResult(true);
}
} else {
document. getElementById("result"). textContent = "❌ Erro.";
setTimeout(() => {
document. getElementById("result"). textContent = "";
}, 1500);
selectedWord. classList. remove("selected");
selectedWord = null;
}
}

function reset() {
matchedPairs = 0;
document. getElementById("result"). textContent = "";
document. getElementById("result"). className = "";
init();
}

function sendResult(sucesso, mensagem) {
window.parent.postMessage({
type: "TASK_RESULT",
sucesso: !!sucesso,
mensagem: mensagem || (sucesso ? "Todos os pares estão corretos" : "Erro")
}, "*");
}

window.onload = init;

window.parent.postMessage({type: "TASK_EXISTS", válido: verdadeiro }, "*");
</script>
</body>
</html>