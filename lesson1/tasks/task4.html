<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="../../tasks.css">
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Discurso Direto</title>
</head>
<body>

<h2>Discurso Direto em Inscrições Oracle</h2>
<p class="intro">Selecione a parte do texto que é uma pergunta direta.</p>

<div class="oracle-text">Discurso Direto em Inscrições Oracle</div>

<div class="pinyin-container">
<button class="pinyin-toggle" onclick="this.nextElementSibling.classList.toggle('expanded'); this.classList.toggle('expanded')">
Mostrar Pinyin
</button>
<div class="pinyin-text">zhēn dīng mǎo qí yǔ wáng zhàn yuē qí yǔ</div>
</div>

<div class="question">Qual ​​parte é uma pergunta direta ao oráculo?</div>

<div id="options-container" class="options"></div>

<button onclick="checkAnswer()">Verificar</button>
<div id="result"></div>
<div id="explanation" style="display: none;">
<p><strong>Explicação:</strong></p>
<ol>
<li><strong>貞</strong> introduz uma pergunta — este é um discurso direto.</li>
<li><strong>王占曰</strong> — o rei interpretou, também discurso direto, mas é uma resposta.</li>
</ol>
<p><strong>「貞丁卯其雨」</strong> — a pergunta completa: "Vai chover?"</p>
</div>

<roteiro>
opções const = [
{ id: 1, texto: "貞丁卯其雨", correto: verdadeiro },
{ id: 2, texto: "王占曰其雨", correto: falso },
{ id: 3, texto: "丁卯其雨", correto: falso },
{ id: 4, texto: "貞丁卯", correto: falso }
]; 

deixe selecionadoOptionId = null; 

function shuffleArray(matriz) {
const arr = [...matriz]; 
para (seja i = arr.length - 1; i > 0; i--) {
const j = Math.floor(Math.random() * (i + 1));
[arr[i], arr[j]] = [arr[j], arr[i]];
}
return arr;
}

function renderOptions() {
const container = document.getElementById("options-container");
container.innerHTML = "";

const shuffled = shuffleArray(opções);

embaralhado.forEach(opção => {
const optionEl = document.createElement("div");
optionEl.className = "opção";
optionEl.textContent = opção.texto;
optionEl.dataset.id = opção.id;
optionEl.onclick = () => selectOption(opção.id);
container.appendChild(opçãoEl);
});
}

function selectOption(id) {
selectedOptionId = id;
document.querySelectorAll('.opção').forEach(el => {
el.classList.remove('selecionado');
});
document.querySelector(`.opção[data-id="${id}"]`).classList.add('selecionado');
}

function checkAnswer() {
const resultEl = document.getElementById('resultado');
const explanationEl = document.getElementById('explicação');

if (!selectedOptionId) {
resultEl.textContent = "Selecione uma opção";
resultEl.className = "erro";
return;
}

const correct = options.find(o => o.id === selectedOptionId).correct;

if (correto) {
resultEl.innerHTML = "✅ <b>Correto!</b>";
resultEl.className = "sucesso";
explainEl.style.display = "bloquear";
sendResult(true);
} else {
resultEl.textContent = "❌ Incorreto.";
resultEl.className = "error";
explanationEl.style.display = "block";
sendResult(false, "Erro na detecção de fala direta");
}
}

function sendResult(sucesso, mensagem) {
window.parent.postMessage({
type: "TASK_RESULT",
success: !!success,
message: mensagem || (sucesso ? "Correto" : "Erro")
}, "*");
}

window.onload = renderOptions;

window.parent.postMessage({
type: "TASK_EXISTS",
valid: true
}, "*");
</script>
</body>
</html>